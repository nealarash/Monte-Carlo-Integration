---
title: "PSTAT 194CS Final Project"
author: ' Neala Rashidfarrukhi'
date: "6/2/2022"
output:
  html_document: default
  pdf_document: default
---

\DeclareUnicodeCharacter{00A0}{ }

```{r setup, echo = FALSE, message = FALSE, warning = FALSE}
library(knitr)
library(tidyverse)
library(dplyr)
library(pander)
library(boot)
library(tinytex)
```


# Introduction

In this project, we will be looking at external and internal factors to analyze how these variables affect mental health using sampling methods. The data published by the CDC is a collaborative project in all of the states within the United States called the Behavioral Risk Factor Surveillance System (BRFSS). The BRFSS is “a system of ongoing health-related telephone surveys designed to collect data on health-related risk behaviors, chronic health conditions, and use of preventive services from the noninstitutionalized adult population (≥ 18 years) residing in the United States” (Overview: BRFSS 2020 1). This program collects data on health risk behaviors, chronic diseases, and conditions in order to use preventative health services related to the leading causes of disability and death in the United States. There are many variables assessed by the BRFSS during the telephone surveys, but the variables we will be looking into in this project are Physical Activity, BMI, and Education. The main question we will be posing is: How do different levels of physical activity, BMI, and Education have a direct impact on the mental health status of individuals? If we can determine that there is a positive correlation between these variables, then with scientific research there can be plausible solutions to help people who suffer from negative mental health due to lack of physical activity, lack of education, and an increased BMI. 


# Methods and Results

### Assoaciation between BMI and Mental Health Status

In order to further understand and analyze the relationship between Body Mass Index and Mental health Status we will be using two types of sampling methods: Cluster Sampling and Systemic Sampling. Cluster Sampling is when we divide data into smaller "clusters" and sample from this data. Systemic Sampling is a sampling method in which sample members from a larger population are selected according to a random starting point but with a fixed, periodic interval. This interval, called the sampling interval, is calculated by dividing the population size by the desired sample size. Both these methods are very similar to stratified sampling. 

We hypothesize that there will be a weak positive assocation between BMI and Mental Health Status. We will test our hypothesis using 3 methods.\
(1) Cluster Sampling \
(2) Systemic Sampling \
(3) Accept/Reject Method \

```{r, warning=FALSE}
DATA<- read.csv("/Users/nealarashidfarrukhi/Downloads/brfss.csv")
DATA[DATA==0] <- NA
DATA<-DATA[complete.cases(DATA),]
```

We will look at Mental Health Status against BMI. From this we can see that it has a bell shaped curve which follows the normal distribution.

```{r, warning=FALSE, fig.height = 3, fig.width = 5, fig.align = "center"}
ggplot(DATA, aes(x=DATA$BMI, y=DATA$X_MENT14D)) +geom_histogram(stat='identity', col='Blue') +
  xlab("Body Mass Index") + ylab("Mental Health") +ggtitle("Mental Health(X_MENT14D) vs. Body Mass Index(BMI)")
```


### Cluster Sampling
We will use one-stage Cluster Sampling and look at BMI based off of 4 levels. 1 being underweight and 4 being obese.

```{r, warning=FALSE}
set.seed(1)
clusters <- sample(unique(DATA$BMI, DATA$X_MENT14D), size=100, replace=F)

cluster_sample <- DATA[DATA$BMI %in% clusters, ]

table(cluster_sample$BMI)

```

We will look at a histogram of our sampled values. We can see that most people lie within a BMI of 2 or 3 which is normal weight or overweight.

```{r,warning=FALSE, fig.height = 3, fig.width = 5, fig.align = "center"}
ggplot(cluster_sample, aes(x=BMI, y=X_MENT14D)) +geom_histogram(stat='identity', col='Blue') +
  xlab("Body Mass Index") + ylab("Mental Health") + ggtitle("Cluster Sample Graph")
```

Let's see if there is a correlation between BMI and Mental Health Status using the one-stage cluster sampling.

```{r, warning=FALSE}
cor(cluster_sample[["BMI"]], cluster_sample[["X_MENT14D"]])
```

We get a correlation of 0.0203 which is a weak positive correlation. Thus we can conclude that there is some association between Mental Health Status and BMI, but no direct correlation.


### Systemic Sampling

Let's use systemic sampling to sample from a large population, and divide the data into our desired sample size.

```{r, warning=FALSE}
#define function to obtain systematic sample
set.seed(1)

obtain_sys = function(N,n){
  k = ceiling(N/n)
  r = sample(1:k, 1)
  seq(r, r + k*(n-1), k)
}

#obtain systematic sample
sys_sample_df = DATA[obtain_sys(nrow(DATA), 100), ]

#view first six rows of data frame
# head(sys_sample_df)
```

```{r, warning=FALSE, fig.height = 3, fig.width = 5, fig.align = "center"}
ggplot(sys_sample_df, aes(x=sys_sample_df$BMI, y=sys_sample_df$X_MENT14D)) +geom_histogram(stat='identity', col='Blue') +
  xlab("Body Mass Index") + ylab("Mental Health") +ggtitle("Systemic Sample Graph")
```

```{r,warning=FALSE}
sample1<- sys_sample_df[-c(98:nrow(sys_sample_df)),]
cor(sample1[["BMI"]], sample1[["X_MENT14D"]])
```

We can see again here with systemic sampling that there is a correlation of 0.1436 between BMI and Mental Health Status. Thus we can conclude that there is a positive association between BMI and Mental Health Status.

### Accept/Reject Method

In order to use this method we will be looking at another column corresponding to Body Mass Index(BMI), which is calculated BMI represented in kilometers per meter squared. We must show that BMI is normally distribution, and we will implement a logarithmic transformation to do so.

```{r,  warning=FALSE}
hist(DATA$BMI)
# transform the data frame
x<- log(DATA$BMI)
hist(x)
qqnorm(x)
qqline(x)
```

We can say that this fits the normal distribution. Now we will calculate $\sigma$ and $\mu$ for the normal distribution. We know that BMI follows a normal distribution so we will fit it to a normal PDF where we calculated $\sigma=1.188876$ and $\mu=2.837739$.


```{r, fig.height = 3, fig.width = 5, fig.align = "center"}
curve(1/1.188876*sqrt(2*pi)*exp((-1/2)*((x-2.837739)/1.188876))^2, 1, 4)
abline(a = .425167, b =0)

set.seed(1)

X = rnorm(4500, 0, 1) # we will reject some of these values
U = rnorm(4500, 0 ,1) # want this many because we want at least 1000 to random variables to fit our distribution


# targest distribution
pi_x <- function(x) { #accept-reject formula
  new_x = (1/1.188876*sqrt(2*pi)*exp((-1/2)*((x-2.837739)/1.188876))^2)
  return(new_x)
}

count = 1
accept = c() #empty vector that we will fill with the accepted random values from X

# Keep cycling until our sample size reaches 1000
while(count <= 4500 & length(accept) < 1000){
  test_u = U[count]
  test_x = pi_x(X[count])/(.27067*dunif(X[count],0,1))
  if (test_u <= test_x){
    accept = rbind(accept, X[count])
    count = count + 1
  }
  count = count + 1
}

hist(accept, col="Blue")
```

Overall, we can see that the histgram of our simulated values fits our original curve so we can say that the accept/reject method worked.

